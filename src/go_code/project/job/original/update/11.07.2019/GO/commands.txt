docker pull sconecuratedimages/crosscompilers:scone

#docker run -it sconecuratedimages/crosscompilers:scone
docker run --cap-add SYS_PTRACE -it -p 9090:8080 -v "$PWD"/EXAMPLE:/usr/src/myapp -w /usr/src/myapp  sconecuratedimages/crosscompilers:scone

cat > /etc/sgx-musl.conf << EOF
Q 1
e 0 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
s 1 0 0
EOF
cat > web-srv.go << EOF

package main

import (
    "fmt"
    "net/http"
)

func handler(w http.ResponseWriter, r *http.Request) {
    fmt.Fprintf(w, "Hi there, I love %s!", r.URL.Path[1:])
}

func main() {
    http.HandleFunc("/", handler)
    http.ListenAndServe(":8080", nil)
}
EOF

SCONE_HEAP=1G scone-gccgo web-srv.go -O3 -o web-srv-go -g

SCONE_MODE=HW SCONE_ALLOW_DLOPEN=2 SCONE_VERSION=1 ./web-srv-go
SCONE_MODE=HW SCONE_VERSION=1 ./web-srv-go
#container:
scone-gdb ./web-srv-go
set environment SCONE_ALLOW_DLOPEN=2
set environment SCONE_VERSION=1 
set environment SCONE_MODE=HW
set environment SCONE_ALPINE=1

handle SIGILL nostop pass
run 

# symbols?!?
quit
exit
#exit
exit
